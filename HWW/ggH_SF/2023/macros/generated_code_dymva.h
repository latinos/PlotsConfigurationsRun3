
    // Select all (Ctrl+A), Copy (Ctrl+C), paste to an empty text file (Ctrl+V) and save that file as 'generated_code.h'
    // 
    // Auto-generated header file. Assumes img to be a floating point array
    // of 64 elements (corresponding to an 8x8 b&w image)

    #include <math.h>

    float norma_SigSNN;
    
inline float activation_SigSNN_0 (float x, float n) 
{ return x > 0 ? x : 0;}
inline float activation_SigSNN_1 (float x, float n) 
{ return x > 0 ? x : 0;}
inline float activation_SigSNN_2 (float x, float n) 
{ return exp(x)/n;  }

    float guess_SigSNN (const float *img, int flag)
    {
    
  // Declare the arrays in the stack
  const float kernel_0[23][20] = 
  {{  -0.0600657016039,  -0.3954665064812,   0.4401122331619,  -0.3547120094299,   0.2507920563221,   0.3722165524960,   0.0486008189619,  -0.1633798480034,  -0.2019433677197,   0.0376283749938,   0.1821220219135,  -0.4837668538094,  -0.0645840764046,  -0.3644266426563,   0.2649714946747,   0.0303560663015,   0.1203976199031,  -0.1045797094703,  -0.3373535573483,   0.2643478214741},
   {   0.0022995152976,  -0.0543735437095,   0.0237884391099,   0.2841345965862,  -0.2041085064411,   0.4064121842384,   0.0178706217557,  -0.0703993439674,  -0.2531255185604,  -0.1489856392145,   0.0341375023127,  -0.0241685900837,  -0.4401679337025,  -0.0867104232311,  -0.2886859476566,   0.0087235933170,   0.2358020693064,  -0.2140561491251,  -0.3277128636837,  -0.4109923243523},
   {   0.4361823201180,  -0.0597461834550,   0.2482289224863,   0.2614072561264,  -0.2802973091602,   0.2454460114241,   0.1767793744802,  -0.1122626215219,   0.1783068180084,  -0.4520638287067,  -0.1164319291711,   0.2143582403660,  -0.0730609819293,   0.3248625397682,  -0.2314516007900,   0.0206846836954,   0.2040834873915,  -0.1830553859472,  -0.2439964562654,  -0.2666714489460},
   {   0.3570508658886,  -0.0729592740536,   0.1527408659458,  -0.4651111066341,   0.0670261979103,   0.0744794905186,  -0.5407702326775,   0.0035600354895,   0.2252293527126,  -0.2412423342466,  -0.2082962393761,   0.0616409517825,  -0.0023386706598,  -0.3490590751171,  -0.2369028031826,  -0.3049975633621,  -0.2820440828800,  -0.2213599532843,  -0.3228499889374,   0.2437373399734},
   {   0.1893533617258,  -0.1761287301779,  -0.0667056143284,   0.1014641299844,  -0.2279051244259,  -0.1517094224691,   0.0073755821213,   0.1503593474627,  -0.0342179574072,  -0.0432464443147,   0.1155595034361,   0.2322514057159,  -0.2169583886862,   0.0395643636584,  -0.0982825160027,   0.0679094567895,   0.1319896429777,   0.2913160920143,  -0.3833095431328,   0.3272363543510},
   {   0.2980248332024,  -0.0221766419709,  -0.1313241869211,  -0.2997632622719,  -0.2946788966656,   0.1414408981800,  -0.0132080698386,   0.2953511774540,  -0.0848216339946,   0.0982337221503,   0.3456493616104,  -0.0991564542055,   0.2069018781185,   0.1350157707930,   0.0398653708398,  -0.0768410637975,  -0.4119346141815,  -0.2968101799488,   0.0607681423426,   0.1716243177652},
   {  -0.0881906822324,  -0.0041185482405,   0.5022595524788,  -0.1398567855358,   0.1781383603811,  -0.1374221444130,   0.2399827241898,  -0.1356338113546,   0.0447537899017,  -0.3743048012257,   0.2722109854221,  -0.1886656135321,   0.0451538525522,   0.0065661226399,  -0.0004682402359,  -0.1045733094215,  -0.3696959912777,   0.1114728450775,  -0.4233850240707,  -0.2839980721474},
   {  -0.2884815037251,   0.0653299689293,   0.0065014054999,   0.1590995043516,  -0.2443871051073,   0.1941136121750,   0.0384455248713,  -0.2849808037281,   0.1588700264692,   0.0704308450222,  -0.1205710023642,   0.0617360733449,  -0.1057976484299,  -0.0152219189331,  -0.0328161753714,   0.0181733146310,  -0.3025127351284,   0.1390896290541,  -0.1177372410893,  -0.1910812556744},
   {   0.3293380737305,   0.3282777965069,   0.1646284610033,   0.3714908063412,  -0.1391558647156,  -0.0176896024495,  -0.0845634937286,   0.2954841852188,   0.0454253293574,  -0.4236929118633,  -0.0059435060248,  -0.0627641752362,  -0.2393521070480,   0.2408228069544,  -0.3331352472305,   0.3604570925236,  -0.0884959325194,  -0.3397946059704,   0.1492114067078,   0.1687321662903},
   {  -0.0353531241417,  -0.2266500592232,  -0.2779300212860,   0.4381123483181,  -0.0245637930930,  -0.0005903881975,   0.0335718691349,  -0.1245576441288,  -0.2298794537783,  -0.1461308598518,  -0.0934978276491,   0.0605442225933,  -0.1587792634964,  -0.0809151530266,  -0.0976976752281,  -0.1734234541655,  -0.0064047002234,   0.3758218288422,  -0.1401018053293,  -0.0053927167319},
   {  -0.0556463077664,   0.4895166754723,   0.1588341444731,  -0.1031554564834,   0.1055623814464,   0.3459210395813,  -0.0593796521425,   0.2452741265297,   0.2132648378611,  -0.0939399227500,  -0.1050462201238,  -0.0250299293548,  -0.3226355016232,  -0.0916636139154,  -0.0369167514145,   0.5901345014572,  -0.2930499017239,  -0.1678174436092,  -0.2243867218494,  -0.1266715526581},
   {  -0.1142875552177,  -0.7760391235352,   0.4438455998898,  -0.1980848759413,  -0.0966508686543,  -0.1590206772089,  -0.9645346403122,   0.6262543797493,   0.4136296510696,  -0.1212200224400,   0.0618458017707,   0.6482507586479,   0.0571713186800,  -0.1568364948034,   0.0000633223535,  -0.2926850616932,  -0.2720808088779,  -0.4150040149689,   0.0672030448914,  -0.2154438197613},
   {  -0.1660382747650,   0.4517457485199,  -0.3088105320930,  -0.1117166429758,   0.3281678855419,  -0.4933472275734,   0.1892389059067,  -0.5734844207764,  -0.3640507459641,   0.0251337867230,   0.0853979215026,  -0.2398005723953,   0.2355998456478,   0.3587899208069,   0.2312204390764,   0.5316796898842,  -0.1420188695192,   0.0211682096124,  -0.2155901342630,   0.2028142809868},
   {  -0.1377097964287,   0.0210594572127,   0.1269514262676,  -0.2914824187756,   0.0359483286738,   0.0335611440241,  -0.0685415342450,  -0.0318563804030,   0.1122039631009,  -0.3088936209679,   0.1029916480184,  -0.0508827008307,   0.3077423572540,  -0.0501303337514,   0.2746186256409,   0.1223381981254,   0.3501115739346,   0.0058903214522,   0.3155350387096,  -0.1080504879355},
   {   0.0181052219123,  -0.3448304533958,   0.1309623718262,   0.0238517653197,   0.1143182963133,  -0.2262185066938,  -0.1371229439974,   0.3220459818840,   0.1986795663834,   0.2987023591995,  -0.0809522718191,   0.1767261475325,   0.2569722235203,   0.2053364068270,   0.1436428427696,  -0.3260639011860,  -0.1120308935642,  -0.4974212348461,   0.2090994119644,   0.1727397143841},
   {  -0.1995402127504,   0.8086374402046,  -0.2679926156998,   0.1525001376867,  -0.0005514611839,  -0.2256807684898,   1.0053806304932,  -0.6068549752235,  -0.4675595164299,   0.2525337040424,   0.1663307845592,  -0.4223874807358,   0.2060331404209,   0.3128768503666,  -0.2714704275131,   0.1915074437857,   0.2657893598080,   0.1188038662076,  -0.2065764218569,   0.2783647477627},
   {  -0.0901265889406,  -0.0319462679327,  -0.2235295772552,   0.1403080821037,  -0.0942516848445,   0.3188703954220,  -0.0371208339930,   0.1048804894090,  -0.3632133007050,  -0.5113298296928,  -0.0045359940268,  -0.1115464344621,   0.1742572039366,  -0.1094765365124,   0.1935968548059,   0.0789047330618,   0.2660346925259,  -0.1018416732550,   0.1151317656040,   0.2604126930237},
   {   0.1577806025743,   0.0504637584090,  -0.2498172223568,  -0.3429854214191,  -0.0524834692478,   0.0806634500623,   0.0733992755413,   0.0985523760319,   0.1932604759932,   0.1061480268836,  -0.1168047934771,   0.1303167045116,  -0.0357058197260,   0.2250913530588,   0.2456722706556,   0.0354353487492,   0.2714835703373,  -0.2237179875374,   0.0048907771707,   0.3871021270752},
   {   0.0970851033926,   0.0071894023567,   0.1147544160485,  -0.0167069304734,   0.0436179153621,  -0.0718573257327,  -0.0052466709167,  -0.0030748061836,  -0.0851334035397,  -0.1041012778878,  -0.1389908045530,  -0.0125609077513,  -0.0573808588088,  -0.0336869582534,  -0.0205403864384,  -0.0165965165943,  -0.0149723626673,   0.0044472990558,   0.2652973532677,   0.0366781577468},
   {   0.0280831884593,  -0.0952912420034,   0.1651031970978,   0.4243614971638,   0.2232716530561,  -0.3863818347454,   0.0446867980063,  -0.3242109715939,   0.4542803466320,  -0.0208308994770,  -0.4462000727654,   0.1971687376499,  -0.2796845436096,   0.0040371236391,  -0.4318261444569,   0.3399905264378,  -0.5242078304291,   0.0164075195789,   0.0232653431594,   0.2536817193031},
   {   0.0201008841395,   0.0529153682292,  -0.0624315515161,  -0.0533309653401,  -0.1351647228003,   0.0158587656915,  -0.0744862258434,   0.0999286919832,  -0.1065325513482,   0.2435358166695,  -0.1243868991733,  -0.0818904265761,  -0.0057338839397,  -0.1675307005644,   0.1971563845873,   0.1532830744982,  -0.2644104957581,  -0.1332848668098,  -0.2354683727026,  -0.0546527393162},
   {   0.0284848324955,  -0.0620634816587,   0.1734653562307,   0.1722169965506,  -0.2256533354521,   0.0564011298120,   0.0182177871466,   0.0169404987246,  -0.1538505256176,  -0.3198230266571,  -0.0655381381512,  -0.0469619967043,   0.0856823548675,  -0.4002300202847,  -0.4945199191570,   0.1058324351907,  -0.2693645656109,   0.2734307348728,  -0.1168191283941,   0.1421544402838},
   {  -0.0434159487486,   0.0974151045084,  -0.1202697828412,  -0.0928902402520,   0.2123326063156,  -0.1452949494123,   0.0552803352475,  -0.0193845611066,  -0.0484169423580,  -0.2186843901873,  -0.1586271673441,   0.0537704750896,  -0.0361409783363,  -0.3558501899242,   0.0468234904110,  -0.1472434103489,  -0.1226817816496,  -0.3493531644344,   0.0651524364948,  -0.1075739935040}};
  const float bias_0[20] = {   0.3661178350449,   0.2820280492306,   0.3651579320431,   0.1478957831860,  -0.0110618155450,   0.2669461965561,   0.3007681071758,   0.2906702160835,   0.0890199244022,   0.1329869329929,  -0.0605780780315,   0.3029459118843,   0.1600828319788,  -0.0289298780262,  -0.0883349627256,   0.1197344884276,   0.1955835521221,   0.0816047191620,  -0.0510725863278,   0.2946674823761};
  // Declare the arrays in the stack
  const float kernel_1[20][20] = 
  {{  -0.3653416931629,   0.3461104333401,  -0.3113873898983,   0.2499031722546,  -0.2445064336061,  -0.0539634935558,   0.1703280210495,  -0.0987415462732,  -0.2611154615879,   0.0276827067137,   0.1794998347759,   0.1639087945223,   0.3167886734009,  -0.1031841635704,  -0.1898288428783,   0.2971689999104,   0.1279642134905,  -0.1279050856829,   0.3522839248180,  -0.1114837229252},
   {   0.1529900580645,   0.0120814349502,   0.1486212313175,  -0.0603727363050,   0.4719200134277,  -0.0906073525548,  -0.2136920690536,   0.3635174632072,   0.5774320960045,   0.1527925729752,  -0.0734195858240,  -0.5575289130211,  -0.1457816809416,  -0.1491602063179,   0.5722963213921,  -0.2051558494568,  -0.2603465616703,   0.6457144618034,   0.4035691618919,   0.2610333859921},
   {   0.1618723571301,   0.2497340291739,  -0.3408137857914,  -0.1504131108522,   0.0992560088634,   0.3267280459404,  -0.1943589001894,  -0.6922804713249,   0.3146710693836,  -0.1122374087572,   0.4151598811150,   0.3122481107712,   0.2648550570011,  -0.2361876964569,   0.2802746593952,   0.2127028256655,   0.3640992641449,   0.2162137031555,   0.0066099911928,  -0.2243337035179},
   {  -0.4851321578026,  -0.0672052800655,  -0.1695894002914,   0.0228953193873,   0.4373069405556,   0.2127366364002,   0.2429098486900,   0.0560105293989,   0.1240810677409,  -0.0562126375735,   0.3174440562725,   0.0168980062008,  -0.0194554515183,   0.0201914142817,   0.1584598571062,  -0.1917055100203,   0.1816426217556,  -0.1093855127692,   0.1952585726976,  -0.0953597277403},
   {  -0.2694178521633,   0.0402203351259,  -0.0427386872470,   0.2975491285324,  -0.0501072444022,   0.0021955932025,  -0.1466262638569,  -0.7232527136803,   0.1572744995356,  -0.0811027660966,  -0.1297247856855,   0.3170336186886,  -0.0722462162375,  -0.1477945894003,   0.2890799939632,  -0.1223104149103,  -0.2265197485685,   0.0990007668734,   0.3543886244297,  -0.0990033298731},
   {   0.0746143162251,   0.1292832195759,  -0.3742486238480,   0.1154292523861,  -0.0061558573507,  -0.4159086644650,   0.2639562487602,   0.0400000438094,   0.0316340848804,   0.2892732620239,   0.1247061491013,   0.3823877573013,   0.3143373429775,   0.2402055412531,   0.1605815142393,  -0.0397228039801,   0.1049433201551,   0.4719943106174,  -0.3835471868515,  -0.1400847882032},
   {   0.4875440895557,  -0.3259263932705,   0.0860401019454,   0.6316428184509,  -0.1913978010416,  -0.5332622528076,  -0.6992421150208,   0.0625012144446,   0.7555801868439,  -0.2320693284273,  -0.4962638914585,  -0.4344514608383,  -0.3316100835800,   0.1757721900940,   0.2520909607410,   0.1441223472357,  -0.1138970479369,   0.6728894114494,   0.2065931260586,   0.1315061599016},
   {  -0.1157304942608,   0.1305345296860,  -0.1030867770314,  -0.1116403713822,  -0.2774015367031,  -0.0671244189143,   0.6804429292679,  -0.1442591995001,  -0.0731442123652,   0.3493259549141,   0.4841960966587,   0.4718384444714,   0.0919165685773,   0.5738552212715,  -0.3028315603733,   0.0305295586586,   0.5125913619995,  -0.8821581602097,  -0.4658009111881,  -0.0807136446238},
   {  -0.4161771237850,   0.1377295702696,  -0.2430594563484,  -0.3449178040028,   0.2345969527960,   0.0455282106996,   0.6614423990250,   0.0128950830549,  -0.0785689353943,   0.4343932569027,  -0.2103019952774,   0.2197132408619,  -0.2581021189690,  -0.1817316710949,  -0.0914041996002,  -0.1216397657990,   0.2067581713200,  -0.0817281603813,  -0.2035483270884,  -0.0004307115451},
   {   0.4662545919418,  -0.2457071691751,  -0.1503147929907,   0.1982264369726,   0.2315227836370,   0.0101778106764,  -0.2348102927208,  -0.3957728147507,   0.0748302862048,  -0.1365957856178,   0.3168332874775,   0.2598313391209,  -0.3597300946712,   0.1855827420950,   0.0445670299232,  -0.4017373323441,   0.1827369481325,   0.2075171917677,   0.4121528267860,  -0.2646271586418},
   {   0.2329977601767,   0.0785459876060,   0.3252670764923,  -0.2583792507648,  -0.2963779866695,   0.2186978161335,   0.1183490082622,  -0.5189346075058,  -0.0842365249991,   0.0622631199658,  -0.2360423356295,  -0.1019107326865,   0.1531653851271,  -0.0041180704720,   0.0365730226040,  -0.0716990604997,   0.0858499631286,   0.1739920824766,  -0.0668787956238,  -0.0665515139699},
   {   0.1213675290346,  -0.1575113087893,  -0.0315023437142,  -0.3367674052715,  -0.0315689072013,   0.4130021631718,   0.4793440997601,  -0.1964128017426,  -0.3428464531898,  -0.0357731916010,   0.3384700417519,   0.2291169464588,  -0.0723422393203,   0.4193223416805,  -0.3793300986290,   0.2287568897009,   0.0705073550344,  -0.3919295370579,  -0.0706297010183,  -0.0091368257999},
   {  -0.0128295337781,   0.3883622288704,  -0.3271961212158,  -0.0177585128695,  -0.0070867934264,   0.4461003839970,  -0.2300333380699,  -0.0652424246073,  -0.2011884748936,   0.2006943672895,   0.0393953584135,  -0.1185099408031,   0.3001537322998,  -0.2435212582350,   0.0933109074831,   0.1680584549904,  -0.1679236739874,   0.3336178958416,   0.1795796006918,   0.4269852042198},
   {  -0.1190766692162,   0.1086905151606,  -0.0404316261411,   0.3699460029602,  -0.2063786834478,  -0.0181426741183,  -0.0759540423751,   0.0367475263774,   0.4096587598324,  -0.2711077630520,  -0.0373899750412,  -0.2295999825001,   0.1943303197622,   0.0168774593621,   0.2307143509388,   0.2648496925831,  -0.1498476564884,  -0.1216567903757,  -0.0610717125237,  -0.0613639764488},
   {   0.0706732273102,  -0.0587859340012,   0.2611639797688,   0.4270134568214,  -0.1336400657892,  -0.0528671331704,  -0.2035248875618,   0.4200929403305,   0.3114588856697,   0.1218478009105,   0.0146475629881,  -0.0000032585522,   0.2280898988247,  -0.2650972902775,  -0.1739902496338,  -0.0941153392196,   0.3331208229065,  -0.1405125409365,   0.3007370531559,  -0.2094414234161},
   {   0.1512304842472,  -0.2966292202473,  -0.1253795027733,   0.0322058871388,  -0.1515602320433,  -0.1098823994398,  -0.0060706865042,  -0.4994277060032,   0.1979404836893,  -0.0038619954139,  -0.3313936889172,  -0.3594990670681,   0.1157813146710,  -0.2700682580471,   0.1616387963295,  -0.1027103736997,  -0.0021172780544,   0.4183942675591,   0.3909996449947,   0.3539139926434},
   {   0.0574888996780,  -0.4982191324234,  -0.3207190036774,   0.3541553020477,  -0.2558251321316,   0.3213340640068,   0.3118426501751,  -0.2248607426882,   0.3503359258175,   0.3009063303471,  -0.0021841609851,   0.2175593376160,   0.2244112789631,   0.3988501727581,  -0.2718650102615,   0.4108014106750,   0.4136984646320,   0.4839270710945,   0.5081060528755,   0.2170279771090},
   {   0.4746903777122,   0.2017927169800,  -0.0281883031130,   0.3245799243450,   0.0953616052866,  -0.2380394041538,   0.1418336778879,   0.5519465804100,  -0.0572068467736,  -0.3366320133209,  -0.0141633413732,   0.2899876534939,   0.2648102939129,   0.1817126423120,   0.1947192847729,   0.2462555468082,  -0.2396916002035,  -0.0253770072013,   0.0880582779646,   0.3599748313427},
   {   0.3524279594421,   0.0479081161320,  -0.1055297777057,  -0.1874185651541,   0.2981322109699,   0.0745350942016,   0.1906398236752,   0.1321056187153,  -0.2257130742073,   0.1302441805601,   0.2306562513113,  -0.3586761653423,  -0.1921223551035,  -0.0147025519982,   0.3576475083828,  -0.0393668226898,   0.3077611029148,   0.0338824056089,  -0.2917413413525,  -0.0162909999490},
   {  -0.1002025306225,   0.0557117313147,  -0.3318670690060,   0.3448041677475,   0.1032188832760,   0.2222006320953,  -0.1583553254604,   0.0919237211347,   0.0256495047361,  -0.0785725638270,   0.2284215539694,  -0.2033131271601,  -0.5089786052704,  -0.1811979413033,   0.1185224205256,  -0.5687433481216,  -0.1134134680033,   0.2721586823463,  -0.0301567446440,   0.3271953463554}};
  const float bias_1[20] = {   0.1072692349553,   0.0265420004725,  -0.0453119017184,   0.0621814951301,   0.0454377047718,   0.2584743797779,   0.3579190373421,  -0.1132014095783,   0.0225423257798,   0.1710348576307,   0.0801879540086,   0.2631433010101,  -0.0407323725522,   0.0900696218014,   0.0902621895075,  -0.0463540777564,   0.0061115571298,   0.1726250052452,   0.0533484704792,   0.0708789974451};
  // Declare the arrays in the stack
  const float kernel_2[20][2] = 
  {{   0.2321788370609,   0.4621815681458},
   {   0.4062658548355,  -0.0592743009329},
   {   0.4814024567604,  -0.0227146223187},
   {  -0.6237048506737,   0.3259103298187},
   {  -0.5916212201118,   0.4689135253429},
   {   0.0102562224492,  -0.6937964558601},
   {   0.8099392652512,   0.2271720468998},
   {  -0.8264628052711,   0.0256632696837},
   {  -0.3021916747093,   0.3751041591167},
   {   0.5389255285263,  -0.1379866600037},
   {   0.3838988244534,  -0.4535287022591},
   {   0.2631300687790,  -0.5873826742172},
   {   0.3989305198193,   0.0274510439485},
   {   0.3569484949112,  -0.5987702012062},
   {  -0.2353245019913,   0.1735385954380},
   {  -0.0384601280093,  -0.2753261029720},
   {   0.5515781641006,   0.0601181462407},
   {  -0.5160346627235,   0.7089493274689},
   {   0.1765562742949,   0.5887774825096},
   {  -0.5846015214920,   0.5777771472931}};
  const float bias_2[2] = {  -0.0497029088438,   0.0497029162943};
  float buffer_in[100];
  float buffer_out[100];
  unsigned int i,j,c; 
 float mean[100] = {  49.6395988464355,  47.9196739196777,  28.3472976684570,   0.1871927082539,-2671.5292968750000,-5975.3295898437500,-2602.6613769531250,-5947.9985351562500,  71.8348922729492,   1.7767586708069,  68.9244689941406,-2549.9755859375000,  60.5317916870117,  46.7760505676270,  78.9954452514648,-2829.2094726562500,   2.5369782447815,   2.0333878993988,   0.0002959445992,  59.4178581237793,  31.5144004821777,  -0.0073602772318,  -0.0066597484984};
 float sigma[100] = {  69.5847091674805,  29.4173355102539,  18.8825531005859,   0.2730141878128,4433.6372070312500,4917.9697265625000,4466.0839843750000,4934.8090820312500,  38.4388847351074,   0.9738668203354,  73.7934570312500,4705.5791015625000,  49.7072296142578,  25.9574222564697, 139.5645446777344,4505.4843750000000,   0.6142999529839,   0.8191346526146,   1.5741862058640,  70.7345199584961,  19.9823989868164,   1.1613990068436,   1.1491634845734};




  // Load the input in the buffer
  for (c = 0; c < 64; ++c) 
  buffer_in[c] = (img[c]-mean[c])/sigma[c];
  // Processing layer 0 

                for (c = 0; c < 20; ++c ) 
                  buffer_out[c] = bias_0[c];

                for (c = 0; c < 20; ++c )
                  for (i = 0; i < 23; ++i)
                    buffer_out[c] += buffer_in[i] * kernel_0[i][c];

                norma_SigSNN = 0;

                // Prepares for next layer 
                for (c = 0; c < 20; ++c )
                  buffer_in[c] = activation_SigSNN_0(buffer_out[c], norma_SigSNN);


                
  // Processing layer 1 

                for (c = 0; c < 20; ++c ) 
                  buffer_out[c] = bias_1[c];

                for (c = 0; c < 20; ++c )
                  for (i = 0; i < 20; ++i)
                    buffer_out[c] += buffer_in[i] * kernel_1[i][c];

                norma_SigSNN = 0;

                // Prepares for next layer 
                for (c = 0; c < 20; ++c )
                  buffer_in[c] = activation_SigSNN_1(buffer_out[c], norma_SigSNN);


                
  // Processing layer 2 

                for (c = 0; c < 2; ++c ) 
                  buffer_out[c] = bias_2[c];

                for (c = 0; c < 2; ++c )
                  for (i = 0; i < 20; ++i)
                    buffer_out[c] += buffer_in[i] * kernel_2[i][c];

                norma_SigSNN = 0;

                for(c=0;c<2;++c)
                  norma_SigSNN+=exp(buffer_out[c]);

                // Prepares for next layer 
                for (c = 0; c < 2; ++c )
                  buffer_in[c] = activation_SigSNN_2(buffer_out[c], norma_SigSNN);


                

      //i = 0;
      //for (c = 0; c < 2; ++c)
      //  if (buffer_in[c] > buffer_in[i])
      //    i = c;
      
      if (flag==0) //sig
        return buffer_in[0];
      else if (flag==1) //bkg
        return buffer_in[1];
      return 0;
         
      
      //return i;
    
}
